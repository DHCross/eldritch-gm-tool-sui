<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Eldritch GM Tool Suite</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="src/css/main.css">
    <link rel="stylesheet" href="src/css/gm-tools.css">
</head>
<body>

    <h1>Eldritch GM Tool Suite</h1>

    <div class="tab-nav">
    <button class="tab-link active" onclick="openTool(event, 'EncounterGenerator')">Encounter Generator</button>
    <button class="tab-link" onclick="openTool(event, 'NPCGenerator')">NPC Generator</button>
    <button class="tab-link" onclick="openTool(event, 'CharacterGenerator')">Character Generator</button>
    <button class="tab-link" onclick="openTool(event, 'BattleCalculator')">Battle Calculator</button>
    <button class="tab-link" onclick="openTool(event, 'MonsterHP')">Monster HP</button>
    <div id="CharacterGenerator" class="tab-content">
                <h2>Eldritch RPG 2nd Edition Character Generator</h2>
                <div class="bg-gray-900 p-6 rounded-2xl shadow-lg mb-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 items-end">
                        <div>
                            <label for="cg-race" class="block text-sm font-medium text-green-400 mb-1">Race</label>
                            <select id="cg-race" class="w-full bg-gray-800 border border-green-400 text-gray-100 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-2.5"></select>
                        </div>
                        <div>
                            <label for="cg-class" class="block text-sm font-medium text-green-400 mb-1">Class</label>
                            <select id="cg-class" class="w-full bg-gray-800 border border-green-400 text-gray-100 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-2.5"></select>
                        </div>
                        <div>
                            <label for="cg-level" class="block text-sm font-medium text-green-400 mb-1">Level</label>
                            <select id="cg-level" class="w-full bg-gray-800 border border-green-400 text-gray-100 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-2.5"></select>
                        </div>
                        <div id="cg-magic-path-container" style="display:none;">
                            <label for="cg-magic-path" class="block text-sm font-medium text-green-400 mb-1">Chosen Magic Path</label>
                            <select id="cg-magic-path" class="w-full bg-gray-800 border border-green-400 text-gray-100 text-sm rounded-lg focus:ring-green-500 focus:border-green-500 block p-2.5"></select>
                        </div>
                    </div>
                    <div class="mt-6 flex flex-col sm:flex-row justify-between items-center gap-4">
                        <div class="flex items-center">
                            <input type="checkbox" id="cg-magical-item-checkbox" class="h-4 w-4 text-green-500 border-gray-300 rounded focus:ring-green-500">
                            <label for="cg-magical-item-checkbox" class="ml-2 block text-sm text-gray-100">Iconic Arcane Inheritance (Costs 4 CP)</label>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button id="cg-generate-btn" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors shadow-md">Generate Character</button>
                            <button id="cg-export-md-btn" class="w-full sm:w-auto bg-white hover:bg-gray-100 text-green-600 font-semibold py-2 px-4 border border-green-600 rounded-lg shadow-sm transition-colors">Export Markdown</button>
                            <button id="cg-copy-md-btn" class="w-full sm:w-auto bg-white hover:bg-gray-100 text-green-600 font-semibold py-2 px-4 border border-green-600 rounded-lg shadow-sm transition-colors">Copy Markdown</button>
                        </div>
                    </div>
                </div>
                <div id="cg-character-output"></div>
                <div id="cg-custom-alert" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; justify-content:center; align-items:center;">
                    <div style="background:white; padding:2rem; border-radius:1rem; box-shadow:0 10px 25px rgba(0,0,0,0.1); text-align:center; max-width:90%; width:400px;">
                        <p id="cg-custom-alert-message"></p>
                        <button id="cg-custom-alert-close" style="margin-top:1.5rem; padding:0.75rem 1.5rem; border:none; background-color:#4CAF50; color:white; border-radius:0.5rem; cursor:pointer; font-weight:600;">OK</button>
                    </div>
                </div>
    </div>
    </div>

    <div id="EncounterGenerator" class="tab-content" style="display: block;">
        <h2>Eldritch RPG Encounter Generator</h2>
        
        <div class="slider-container">
            <label for="partySize">Party Size: <span id="partySizeValue">4</span></label>
            <input type="range" id="partySize" min="1" max="4" value="4" class="slider">
        </div>

        <div class="slider-container">
            <label for="defenseLevel">Party Defense Level: <span id="defenseLevelValue">Practitioner</span></label>
            <input type="range" id="defenseLevel" min="1" max="5" value="1" class="slider">
        </div>

        <div class="slider-container">
            <label for="difficulty">Desired Difficulty: <span id="difficultyValue">Moderate</span></label>
            <input type="range" id="difficulty" min="1" max="6" value="2" class="slider">
        </div>

        <div class="slider-container">
            <label for="nonMediumPercentage">Non-Medium Size Percentage: <span id="nonMediumPercentageValue">10</span>%</label>
            <input type="range" id="nonMediumPercentage" min="0" max="100" value="10" class="slider">
        </div>

        <div class="slider-container">
            <label for="nonMundanePercentage">Non-Mundane Nature Percentage: <span id="nonMundanePercentageValue">20</span>%</label>
            <input type="range" id="nonMundanePercentage" min="0" max="100" value="20" class="slider">
        </div>

        <div class="slider-container">
            <label for="specialTypePercentage">Fast/Tough Creature Percentage: <span id="specialTypePercentageValue">30</span>%</label>
            <input type="range" id="specialTypePercentage" min="0" max="100" value="30" class="slider">
        </div>

        <div class="checkbox-container">
            <label><input type="checkbox" name="creatureTypes" value="Minor" checked> Minor</label>
            <label><input type="checkbox" name="creatureTypes" value="Standard" checked> Standard</label>
            <label><input type="checkbox" name="creatureTypes" value="Exceptional" checked> Exceptional</label>
            <label><input type="checkbox" name="creatureTypes" value="Legendary"> Legendary</label>
        </div>

        <button onclick="generateEncounter()">Generate Encounter</button>

        <div id="encounterOutput"></div>
    </div>

    <div id="NPCGenerator" class="tab-content">
        <h2>Eldritch RPG NPC Generator</h2>
        <div>
            <label for="gender">Choose Gender:</label>
            <select id="gender">
                <option value="Random">Random</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
            </select>
        </div>
        <div>
            <label for="race">Choose Race:</label>
            <select id="race"></select>
        </div>
        <div>
            <label for="class">Choose Role:</label>
            <select id="class"></select>
        </div>
        <div>
            <label for="level">Select Level:</label>
            <select id="level"></select>
        </div>
        <div class="checkbox-container">
            <input type="checkbox" id="includeMagic" />
            <label for="includeMagic">Include Magical Properties for Iconic Items</label>
        </div>
        <button onclick="generateCharacter()">Generate Character</button>
        <div id="character"></div>
    </div>

    <div id="BattleCalculator" class="tab-content">
        <h2>Eldritch RPG Battle Phase Calculator</h2>
        
        <div class="combatant-form">
            <h3>Add Combatant</h3>

            <div class="checkbox-container">
                <input type="checkbox" id="autoRollToggle" onchange="toggleAutoRoll()">
                <label for="autoRollToggle">Enable Auto-Roll Armor Dice</label>
            </div>

            <label for="combatantType">Combatant Type:</label>
            <select id="combatantType" onchange="toggleFields()">
                <option value="pa">Player Adventurer (PA)</option>
                <option value="npc">Non-Player Character (NPC)</option>
                <option value="qsb">Quick Stat Block (QSB) Creature</option>
            </select>

            <label for="combatantName">Name:</label>
            <input type="text" id="combatantName" placeholder="Enter combatant name">

            <label for="prowess" id="prowessLabel">Prowess Die:</label>
            <select id="prowess">
                <option value="4" selected>d4</option>
                <option value="6">d6</option>
                <option value="8">d8</option>
                <option value="10">d10</option>
                <option value="12">d12</option>
            </select>

            <div id="reactionFocusGroup">
                <label for="reactionFocus">Reaction Focus Bonus:</label>
                <input type="text" id="reactionFocus" placeholder="Enter Reaction Focus Bonus">
            </div>

            <div id="spiritPointsGroup">
                <label for="spiritPoints">Spirit Points (SP):</label>
                <input type="text" id="spiritPoints" placeholder="Enter Spirit Points">
            </div>
            
            <button onclick="addCombatant()">Add Combatant</button>
        </div>

        <div class="combatant-list">
            <h3>Active Combatants</h3>
            <ul id="turnOrder"></ul>
        </div>

        <div class="defeated-list">
            <h3>Defeated Combatants</h3>
            <ul id="defeatedList"></ul>
        </div>
    </div>

    <div id="MonsterHP" class="tab-content">
        <h2>Eldritch RPG Monster HP Calculator</h2>
        
        <label for="monsterType">Monster Nature:</label>
        <select id="monsterType" name="monsterType">
            <option value="1">Mundane</option>
            <option value="2">Magical</option>
            <option value="3">Preternatural</option>
            <option value="4">Supernatural</option>
        </select>
    
        <label for="monsterSize">Monster Size:</label>
        <select id="monsterSize" name="monsterSize">
            <option value="1">Small or Medium</option>
            <option value="2">Large</option>
            <option value="3">Huge</option>
            <option value="4">Gargantuan</option>
            <option value="0">Minuscule or Tiny</option>
        </select>

        <label for="Tier1Threat">Threat Tier 1 (MV):</label>
        <select id="Tier1Threat" name="minor">
            <option value="4">d4</option>
            <option value="6">d6</option>
            <option value="8">d8</option>
            <option value="10">d10</option>
            <option value="12">d12</option>
            <option value="14">d14</option>
            <option value="16">d16</option>
            <option value="18">d18</option>
            <option value="20">d20</option>
        </select>

        <label for="Tier2Threat">Threat Tier 2 (MV):</label>
        <select id="Tier2Threat" name="standard">
            <option value="0">None</option>
            <option value="4">d4</option>
            <option value="6">d6</option>
            <option value="8">d8</option>
            <option value="10">d10</option>
            <option value="12">d12</option>
            <option value="14">d14</option>
            <option value="16">d16</option>
            <option value="18">d18</option>
            <option value="20">d20</option>
        </select>

        <label for="Tier3Threat">Threat Tier 3 (MV):</label>
        <select id="Tier3Threat" name="exceptional">
            <option value="0">None</option>
            <option value="4">d4</option>
            <option value="6">d6</option>
            <option value="8">d8</option>
            <option value="10">d10</option>
            <option value="12">d12</option>
            <option value="14">d14</option>
            <option value="16">d16</option>
            <option value="18">d18</option>
            <option value="20">d20</option>
        </select>

        <label for="monsterArmor">Monster Armor:</label>
        <select id="monsterArmor" name="monsterArmor">
            <option value="0">None</option>
            <option value="2">Hide</option>
            <option value="3">Leather</option>
            <option value="4">Chain</option>
            <option value="5">Plate</option>
            <option value="6">Magical</option>
        </select>

        <button onclick="calculateMonsterHP()">Calculate Hit Points</button>
        <div id="monsterHPOutput"></div>
    </div>


    <script src="src/js/gm-tools.js"></script>
</body>
</html>